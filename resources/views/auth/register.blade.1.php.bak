@extends('layouts.app')

@section('content')

    
    @include('common.error')
		
		<div class="loignbox registerbox">
			<div class="head">
				<a href="javascript:history.go(-1)" class="goback"><</a>
				<span>注册</span>
				
			</div>
			<div>
				<form class="registerform">
					<div>
						<p>
								<span>手机号：</span>
								<input class="phonenum" name="phonenum" type="text"   />
								<input class="code" type="button" value="获取验证码" onclick="sendCode(this)"/>
						</p>
					
						<span class="tipinfo"></span>
					</div>
					<div>
						<p>
							<span>验证码：</span>
							<input type="text" name="verification_code"  />
						</p>
						<span class="tipinfo"></span>
					</div>
					<div>
						<p>
							<span>输入密码：</span>
							<input type="password" id="password" name="password"  />
						</p>
						<span class="tipinfo"></span>
					</div>
					<div>
						<p>
							<span>确认密码：</span>
							<input type="password" name="confirm_password"/>
						</p>
						<span class="tipinfo"></span>
					</div>
					<div>
						<p>
							<span>身份证：</span>
							<input type="text" name="ID_number" />
						</p>
						<span class="tipinfo"></span>
					</div>
					
					<p style="position: relative;"><input type="submit"value="注册" /></p>
					
				</form>
			</div>
		</div>
		
		
		
		
		
		
		
		
		
		
		
		
		
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <div class="panel panel-default">
                    <div class="panel-heading">Register</div>

                    <div class="panel-body">
                        <form class="form-horizontal" method="POST" action="{{ route('register') }}">
                            {{ csrf_field() }}


                            <div class="form-group{{ $errors->has('phone') ? ' has-error' : '' }}">
                                <label for="phone" class="col-md-4 control-label">Phone</label>

                                <div class="col-md-6">
                                    <input id="phone" type="phone" class="form-control" name="phone" value="{{ old('phone') }}">

                                    @if ($errors->has('phone'))
                                        <span class="help-block">
                                        <strong>{{ $errors->first('phone') }}</strong>
                                    </span>
                                    @endif
                                </div>
                            </div>

                            <div class="form-group{{ $errors->has('verification_code') ? ' has-error' : '' }}">
                                <label for="verification_code" class="col-md-4 control-label">verification_code</label>

                                <div class="col-md-6">
                                    <input id="verification_code" type="verification_code" class="form-control" name="verification_code"
                                           value="{{ old('verification_code') }}">

                                    @if ($errors->has('verification_code'))
                                        <span class="help-block">
                                        <strong>{{ $errors->first('verification_code') }}</strong>
                                    </span>
                                    @endif
                                </div>
                            </div>

                            <div class="form-group{{ $errors->has('password') ? ' has-error' : '' }}">
                                <label for="password" class="col-md-4 control-label">Password</label>

                                <div class="col-md-6">
                                    <input id="password" type="password" class="form-control" name="password">

                                    @if ($errors->has('password'))
                                        <span class="help-block">
                                        <strong>{{ $errors->first('password') }}</strong>
                                    </span>
                                    @endif
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="password-confirm" class="col-md-4 control-label">Confirm Password</label>

                                <div class="col-md-6">
                                    <input id="password-confirm" type="password" class="form-control" name="password_confirmation">
                                </div>
                            </div>

                            <div class="form-group{{ $errors->has('id_card') ? ' has-error' : '' }}">
                                <label for="id_card" class="col-md-4 control-label">id_card</label>

                                <div class="col-md-6">
                                    <input id="id_card" type="id_card" class="form-control" name="id_card" value="{{ old('id_card') }}">

                                @if ($errors->has('id_card'))
                                            <span class=" help-block">
                                    <strong>{{ $errors->first('id_card') }}</strong>
                                    </span>
                                    @endif
                                </div>
                            </div>


                            <div class="form-group">
                                <div class="col-md-6 col-md-offset-4">
                                    <button type="submit" class="btn btn-primary">
                                        Register
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
		<script type="text/javascript" src="{{asset('web/library/jquery.validation/1.14.0/jquery.validate.js')}}"></script>
		<script type="text/javascript" src="{{asset('web/library/jquery.validation/1.14.0/validate-methods.js')}}"></script>
		<script src="{{asset('web/library/jquery.form/jquery.form.js')}}"></script>
		<script>
			var clock = '';
			 var nums = 5;
			 var btn;
			 function sendCode(thisBtn)
			 { 
			 btn = thisBtn;
			 btn.disabled = true; //将按钮置为不可点击
			 btn.value = nums+'秒后获取';
			 clock = setInterval(doLoop, 1000); //一秒执行一次
			 }
			 function doLoop()
			 {
			 nums--;
			 if(nums > 0){
			  btn.value = nums+'秒后获取';
			 }else{
			  clearInterval(clock); //清除js定时器
			  btn.disabled = false;
			  btn.value = '获取验证码';
			  nums = 5; //重置时间
			 }
			 }
			
			
			 $(function(){
				 
				 	var register = $(".registerform").validate({
				 			rules: {
				 				phonenum: {
				 					required: true,
				 					isMobile:true
				 	
				 				},
								verification_code:{
									required: true
								},
								password:{
									required:true,
									minlength:6
								},
								confirm_password:{
									required:true,
									 equalTo: "#password"
								},
								ID_number:{
									required:true,
									isIdCardNo:true
								}
									
				 			},
				 			messages: {
				 				phonenum: {
				 					required: "请输入手机号",
				 					isMobile: "请输入正确手机号"
				 	
				 				},
								verification_code:{
									required: "请输入验证码",
								},
								password:{
									required:'请输入密码',
									minlength:'密码不得少于6位'
								},
								confirm_password:{
									required:"请输入确认密码",
									equalTo: "两次密码输入不一致"
								},
								ID_number:{
									required: "请输入手机号",
									isIdCardNo:"请输入正确的身份证号"
								}
								
				 	
				 			},
							errorPlacement: function(error, element) {                             //错误信息位置设置方法
							 error.appendTo( element.parent().parent().find(".tipinfo"));                            //这里的element是录入数据的对象
							 },
							debug:true,			
				 			submitHandler: function(form) {
				 				$(form).ajaxSubmit({
				 					url: '{{url("army/need/release")}}',
				 					type: 'POST',
				 					dataType: 'JSON',
				 					data: {
				 						
				 						_token: '{{csrf_token()}}'
				 					},
				 				
				 					success: function(res) {
				 					
				 	
				 					
				 					}
				 				});
				 			}
				 	
				 		});
				 
			 })
			
		</script>
@endsection
